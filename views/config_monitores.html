<!doctype html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scoreboard - Configurações</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp" crossorigin="anonymous">
    <link rel="stylesheet" href="../resources/css/config.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- Custom Css -->
    <link rel="stylesheet" href="../resources/css/custom.css">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.4.js"
        integrity="sha256-a9jBBRygX1Bh5lt8GZjXDzyOB+bWve9EiO7tROUtj/E=" crossorigin="anonymous"></script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-qKXV1j0HvMUeCBQ+QVp7JcfGl760yU08IQ+GpUo5hlbpg51QRiuqHAJz8+BrxE/N"
        crossorigin="anonymous"></script>

    <!-- Popper -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.2/umd/popper.min.js"
        integrity="sha512-2rNj2KJ+D8s1ceNasTIex6z4HWyOnEYLVC3FigGOmyQCZc2eBXKgOxQmo3oKLHyfcj53uz4QMsRCWNbLd32Q1g=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>
    <!-- Configuration Css -->
    <link rel="stylesheet" href="../resources/css/configuration.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>

    <style>
        @font-face {
            font-family: 'Gobold';
            src: url('../resources/fonts/gobold_bold.otf') format('truetype');
        }

        html {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            overflow: hidden;
        }

        body {
            /* overflow: hidden; */
            font-family: 'Gobold';
            margin: 0;
            padding: 0;
            width: 100% !important;
        }

        .btn-simples {
            border-radius: 14px !important;
            background-color: #EAE1D0 !important;
        }

        .modal-backdrop.show {
            width: 100% !important;
            height: 100% !important;
        }

        .panel-equipe-title {
            font-size: 18px !important;
        }
    </style>
</head>

<body style="height: 100vh;">
    <div id="app" style="height: 100%;">
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Editar Ecrã</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form @submit.prevent="salvar_item">
                            <input type="hidden" v-model="edit.config">
                            <input type="hidden" v-model="edit.id" />
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="recipient-name" class="col-form-label">Width</label>
                                        <input type="text" class="form-control" v-model="edit.width" />
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="message-text" class="col-form-label">Height</label>
                                        <input type="text" class="form-control" v-model="edit.height" /></input>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <label for="recipient-name" class="col-form-label">Alinhamento</label>
                                    <select class="form-select" v-model="edit.tipo">
                                        <option value="monitor">Displays</option>
                                        <option value="personalizado">Personalizado</option>
                                    </select>
                                </div>
                                <div class="col-md-12 mt-2 d-flex align-items-center">
                                    <label for="recipient-name" class="col-form-label">FullScreen</label>
                                    <input type="checkbox"
                                        style="accent-color: #000; width: 25px;height: 25px; border-radius:2px; margin-left: 29px;"
                                        v-model="edit.fullscreen" />
                                </div>
                                <div class="col-md-12 mt-2">
                                    <div class="row" v-if="edit.tipo =='monitor'">
                                        <div class="col-md-12">
                                            <label for="recipient-name" class="col-form-label">Selecione o
                                                monitor</label><br>
                                            <span style="font-size: 12px; color:rgba(0, 0, 0, 0.658)">A tela será
                                                ajustada
                                                ao monitor selecionado</span>
                                            <select class="form-select" v-model="edit.monitor"
                                                @change="changeTela(edit.id, true)">
                                                <option value="Default">Default</option>
                                                <option v-bind:value="monitor.label" v-for="monitor in telas">
                                                    {{monitor.label}}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row" v-if="edit.tipo =='personalizado'">
                                        <div class="col-md-6">
                                            <label for="recipient-name" class="col-form-label">X</label>
                                            <input type="text" class="form-control" v-model="edit.x" />
                                        </div>
                                        <div class="col-md-6">
                                            <label for="recipient-name" class="col-form-label">Y</label>
                                            <input type="text" class="form-control" v-model="edit.y" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="button" class="btn btn-primary" @click="salvar_item">Salvar</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid" style="height: 93%; padding-left: 0; padding-right: 0;">
            <div class="row" style="height: 100%;">
                <div class="col-12">
                    <div id="opcoesPrincipais" style="margin-top: 12px;margin-left: 10px;">
                        <button class="tab-button" onclick="openTab('configuracoes', this)">Jogo setup</button>
                        <button class="tab-button" onclick="openTab('config_equipas', this)">Equipas</button>
                        <button class="tab-button selected">Monitores</button>
                        <button class="tab-button" onclick="openTab('config_fotos', this)">Vídeo/Fotos</button>
                        <button class="tab-button" onclick="openTab('config_shortcuts', this)">Shortcuts</button>
                        <button class="tab-button" onclick="openTab('config_cores', this)">Cores</button>
                        <button class="tab-button" onclick="openTab('config_sons', this)">Sons</button>
                        <button class="tab-button" onclick="openTab('config_banner_color', this)">Banner Color</button>
                        <button class="tab-button" onclick="retornar();">Sair</button>
                    </div>
                    <div id="Monitores" class="tab-panel">
                        <div class="container-fluid" style="padding-left: 0; padding-right: 0;">
                            <div class="row">
                                <div class="col-12 d-flex justify-content-center">
                                    <div class="row w-50">
                                        <div class="row" style="margin-top:20px ;">
                                            <div class="col-6 panel-equipe-title" style="margin-left:-40px;">
                                                Opção do écran
                                            </div>
                                            <div class="col-12" style="margin-top: 25px;">
                                                <div class="row">
                                                    <div class="col-6 d-flex align-items-center mt-3">
                                                        <input type="checkbox"
                                                            style="accent-color: #000; width: 30px;height: 30px;"
                                                            :checked="config_monitor_1.show_monitor"
                                                            @change="ativaDesativa(1)">
                                                        <div style="margin-left: 10px; ">
                                                            <b style="font-size: 18px;"> Écran público</b>
                                                        </div>
                                                    </div>
                                                    <div class="col-6 mt-3">
                                                        <div class="row">
                                                            <div class="col-6">
                                                                <select id="" class="btn-simples w-100"
                                                                    style="background-color:#EAE1D0; font-weight:bold;"
                                                                    v-model="config_monitor_1.monitor"
                                                                    @change="changeTela(1, false)">
                                                                    <option value="Default">Default</option>
                                                                    <option v-bind:value="monitor.label"
                                                                        v-for="monitor in telas">{{monitor.label}}
                                                                    </option>
                                                                </select>
                                                            </div>
                                                            <div class="col-6">
                                                                <button class="btn-simples" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModal"
                                                                    @click="abrirModal(config_monitor_1, 'config_monitor_1')">Size
                                                                    Position</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-6 d-flex align-items-center mt-3">
                                                        <input type="checkbox"
                                                            style="accent-color: #000; width: 30px;height: 30px;"
                                                            :checked="config_monitor_2.show_monitor" disabled>
                                                        <div style="margin-left: 10px;">
                                                            <b style="font-size: 18px;"> Écran control</b>
                                                        </div>
                                                    </div>
                                                    <div class="col-6 mt-3">
                                                        <div class="row">
                                                            <div class="col-6">
                                                                <select class="btn-simples w-100"
                                                                    style=" font-weight:bold;"
                                                                    v-model="config_monitor_2.monitor"
                                                                    @change="changeTela(2, false)">
                                                                    <option value="Default">Default</option>
                                                                    <option v-bind:value="monitor.label"
                                                                        v-for="monitor in telas">{{monitor.label}}
                                                                    </option>
                                                                </select>
                                                            </div>
                                                            <div class="col-6">
                                                                <button class="btn-simples" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModal"
                                                                    @click="abrirModal(config_monitor_2, 'config_monitor_2')">Size
                                                                    Position</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-6 d-flex align-items-center mt-3">
                                                        <input type="checkbox"
                                                            style="accent-color: #000; width: 30px;height:30px;"
                                                            :checked="config_monitor_3.show_monitor"
                                                            @change="ativaDesativa(3)">
                                                        <div style="margin-left: 10px;">
                                                            <b style="font-size: 18px;"> Écran tempo de ataque 1</b>
                                                        </div>
                                                    </div>
                                                    <div class="col-6 mt-3">
                                                        <div class="row">
                                                            <div class="col-6">
                                                                <select class="btn-simples w-100"
                                                                    style="background-color:#EAE1D0; font-weight:bold;"
                                                                    v-model="config_monitor_3.monitor"
                                                                    @change="changeTela(3, false)">
                                                                    <option value="Default">Default</option>
                                                                    <option v-bind:value="monitor.label"
                                                                        v-for="monitor in telas">{{monitor.label}}
                                                                    </option>
                                                                </select>
                                                            </div>
                                                            <div class="col-6">
                                                                <button class="btn-simples" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModal"
                                                                    @click="abrirModal(config_monitor_3, 'config_monitor_3')">Size
                                                                    Position</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-6 d-flex align-items-center mt-3">
                                                        <input type="checkbox"
                                                            style="accent-color: #000; width: 30px;height:30px;"
                                                            :checked="config_monitor_5.show_monitor"
                                                            @change="ativaDesativa(5)">
                                                        <div style="margin-left: 10px;">
                                                            <b style="font-size: 18px;"> Écran tempo de ataque 2</b>
                                                        </div>
                                                    </div>
                                                    <div class="col-6 mt-3">
                                                        <div class="row">
                                                            <div class="col-6">
                                                                <select class="btn-simples w-100"
                                                                    style="background-color:#EAE1D0; font-weight:bold;"
                                                                    v-model="config_monitor_5.monitor"
                                                                    @change="changeTela(5, false)">
                                                                    <option value="Default">Default</option>
                                                                    <option v-bind:value="monitor.label"
                                                                        v-for="monitor in telas">{{monitor.label}}
                                                                    </option>
                                                                </select>
                                                            </div>
                                                            <div class="col-6">
                                                                <button class="btn-simples" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModal"
                                                                    @click="abrirModal(config_monitor_5, 'config_monitor_5')">Size
                                                                    Position</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-12 mt-5">
                                                <div class="row">
                                                    <div class="col-6 d-flex align-items-center justify-content-start">
                                                        <input type="checkbox"
                                                            style="accent-color: #000; width: 30px;height: 30px; border-radius:2px;"
                                                            :checked="config_monitor_4.show_monitor"
                                                            @change="ativaDesativa(4)">
                                                        <div style="margin-left: 10px;">
                                                            <b style="font-size: 18px;">Mostra écran banner</b>
                                                        </div>
                                                    </div>
                                                    <div class="col-6">
                                                        <div class="row">
                                                            <div class="col-6"></div>
                                                            <div class="col-6">
                                                                <button class="btn-simples" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModal"
                                                                    @click="abrirModal(config_monitor_4, 'config_monitor_4')">Size
                                                                    Position</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <table style="margin-top: 16px;">
                                                    <tbody>
                                                        <tr>
                                                            <td style="padding-left: 12px;">
                                                            </td>
                                                            <td style="padding-left: 8px;">
                                                                <!-- Mostra écran banner -->
                                                            </td>
                                                            <td style="padding-left: 16px;">
                                                                <!-- <button class="btn-simples" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModal"
                                                                    @click="abrirModal(config_monitor_4, 'config_monitor_4')">Size
                                                                    Position</button> -->
                                                            </td>
                                                        </tr>
                                                    <tbody>
                                                </table>
                                            </div>
                                            <!-- Banner Web Streaming -->
                                            <div class="col-12 mt-3">
                                                <div class="row">
                                                    <div class="col-12 d-flex align-items-center justify-content-start">
                                                        <input type="checkbox"
                                                            style="accent-color: #000; width: 30px;height: 30px; border-radius:2px;"
                                                            :checked="banner_web_enabled" @change="toggleBannerWeb()">
                                                        <div style="margin-left: 10px;">
                                                            <b style="font-size: 18px;">Banner Web (Streaming)</b>
                                                            <br>
                                                            <div
                                                                style="display: flex; align-items: center; margin-top: 5px;">
                                                                <input type="text" id="bannerUrlInput"
                                                                    value="http://localhost:3000/banner" readonly
                                                                    style="font-size: 13px; color: #333; background: #f5f5f5; border: 1px solid #ccc; border-radius: 4px; padding: 4px 8px; width: 240px;">
                                                                <button id="copyBannerBtn" type="button"
                                                                    @click.prevent="copyBannerUrl()"
                                                                    style="margin-left: 8px; padding: 4px 10px; font-size: 12px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; transition: all 0.3s ease; position: relative; z-index: 10;"
                                                                    title="Copiar URL">
                                                                    <i class="fa fa-copy"></i> <span
                                                                        id="copyBtnText">Copiar</span>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                                <div class="row" style="margin-top: 30px">
                                    <div class="col-10 d-flex justify-content-end">
                                        <button class="btn-acoes d-none">Cancelar</button>
                                        <button class="btn-acoes" style="margin-left: 8px;"
                                            @click="salvar()">Confirmar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Definição de Variaveis -->
    <script>
        document.addEventListener('keydown', function (event) {
            if (event.keyCode === 116) {
                // O código 116 corresponde à tecla F5
                location.reload();
            }
        });
        let widthWindowPad = 1570;
        let heightWindowPad = 870;
        document.body.style.zoom = 1;
        let oldWindowWidth = widthWindowPad;
        let oldWindowHeight = heightWindowPad;
        function calculateScale(width) {
            const widthIncrement = 1000;
            const scaleIncrement = 1;
            const maxScale = 4; // Define a escala máxima

            const widthDiff = width - widthWindowPad;
            let scaleFactor = Math.max(1 + (Math.floor(widthDiff / widthIncrement) * scaleIncrement), 1);
            scaleFactor = Math.min(scaleFactor, maxScale); // Limita a escala ao máximo definido
            console.log(scaleFactor);
            return scaleFactor;
        }

        function adjustZoom() {
            const baseWidth = 1570;
            const baseHeight = 870;
            const aspectRatio = window.innerWidth / window.innerHeight;
            const baseAspectRatio = baseWidth / baseHeight;
            let scale
            if (aspectRatio < baseAspectRatio) {
                scale = window.innerWidth / baseWidth;
                document.body.style.width = '100%';
            } else {
                scale = window.innerHeight / baseHeight;
                // document.body.style.width = (100 / (aspectRatio * 0.7)) + '%'; // Ajuste o valor 0.5 conforme necessário
            }
            document.body.style.zoom = scale;
            document.body.style.height = (window.innerHeight / scale) + 'px';
            document.body.style.alignItems = "center";
        }

        // Chama a função de ajuste de zoom quando o DOM estiver pronto
        document.addEventListener("DOMContentLoaded", function () {
            adjustZoom();
        });

        // Chama a função de ajuste de zoom sempre que a janela for redimensionada
        window.addEventListener("resize", function () {
            adjustZoom();
        });
        const sqlite3 = require('sqlite3').verbose();
        const { ipcRenderer, screen } = require('electron');
        const path = require('path');
        vue = new Vue({
            el: '#app',
            data: {
                edit: {
                    id: null,
                    width: 0,
                    height: 0,
                    tipo: 'monitor',
                    fullscreen: 0,
                    x: 0,
                    y: 0,
                    monitor: 'Default',
                    min_width: 0,
                    min_height: 0
                },
                telas: [],
                config_monitors: [],
                config_monitor_1: {
                    width: 0,
                    height: 0,
                    x: 0,
                    fullscreen: 0,
                    y: 0,
                    alinhamento: 'default',
                    monitor: 'default',
                    show_monitor: false
                },
                config_monitor_2: {
                    width: 0,
                    height: 0,
                    x: 0,
                    y: 0,
                    fullscreen: 0,
                    alinhamento: 'default',
                    monitor: 'default',
                    show_monitor: false
                },
                config_monitor_3: {
                    width: 0,
                    height: 0,
                    x: 0,
                    y: 0,
                    fullscreen: 0,
                    alinhamento: 'default',
                    monitor: 'default',
                    show_monitor: false
                },
                config_monitor_4: {
                    width: 0,
                    height: 0,
                    x: 0,
                    fullscreen: 0,
                    y: 0,
                    alinhamento: 'default',
                    monitor: 'default',
                    show_monitor: false
                },
                config_monitor_5: {
                    width: 0,
                    height: 0,
                    x: 0,
                    fullscreen: 0,
                    y: 0,
                    alinhamento: 'default',
                    monitor: 'default',
                    show_monitor: false
                },
                banner_web_enabled: false,
            },
            methods: {
                getTelas() {
                    ipcRenderer.send('getDisplays');
                    ipcRenderer.on('getDisplays_', (event, data) => {
                        vue.telas = data;
                    });
                },
                async loadBannerWebConfig() {
                    console.log('Solicitando status do Banner Web via IPC invoke...');
                    try {
                        const status = await ipcRenderer.invoke('getBannerWebStatus');
                        console.log('Recebido status do Banner Web (invoke):', status);
                        this.banner_web_enabled = status;
                    } catch (error) {
                        console.error('Erro ao invocar getBannerWebStatus:', error);
                    }
                },
                async toggleBannerWeb() {
                    this.banner_web_enabled = !this.banner_web_enabled;
                    // Enviar apenas o sinal para o main process, que cuidará do banco e do servidor
                    console.log('Enviando toggleBannerWeb:', this.banner_web_enabled);
                    ipcRenderer.send('toggleBannerWeb', this.banner_web_enabled);
                },
                copyBannerUrl() {
                    const url = 'http://localhost:3000/banner';
                    const btn = document.getElementById('copyBannerBtn');
                    const btnText = document.getElementById('copyBtnText');

                    // Envia para o main process copiar
                    ipcRenderer.send('copyToClipboard', url);

                    // Animação de feedback
                    btn.style.background = '#2196F3';
                    btnText.textContent = 'Copiado!';

                    setTimeout(() => {
                        btn.style.background = '#4CAF50';
                        btnText.textContent = 'Copiar';
                    }, 1500);
                },
                // setTimeout(() => {
                //     if (this.telas.length == 1) {
                //         this.telas = [];
                //     }
                //     //     if (this.telas.length > 1) {
                //     //         this.telas.splice(0, 1);
                //     //     }
                // }, 100)
                // }, 100)
                ativaDesativa(value) {
                    if (value == 1) {
                        this.config_monitor_1.show_monitor = !this.config_monitor_1.show_monitor
                        this.salvar();
                    } else if (value == 2) {
                        this.config_monitor_2.show_monitor = !this.config_monitor_2.show_monitor
                    } else if (value == 3) {
                        vue.config_monitor_3.show_monitor = !vue.config_monitor_3.show_monitor
                        var jquery = $.confirm({
                            title: 'Atenção!',
                            content: 'Por favor, selecione a senha de administrador para alterar a imagem.' + `
                                <div style="padding: 4px;">
                                    <div class="form-group mt-2">
                                        <input type="password" placeholder="Senha" class="pass form-control" required />
                                    </div>
                                </div>`,
                            type: 'red',
                            buttons: {
                                cancel: {
                                    text: 'Cancelar',
                                    btnClass: 'btn-danger',
                                    action: function () {
                                        vue.config_monitor_3.show_monitor = !vue.config_monitor_3.show_monitor
                                    }
                                },
                                confirm: {
                                    text: 'Confirmar',
                                    btnClass: 'btn-success',
                                    action: function () {
                                        var alerta = null;
                                        const pass = document.querySelector('.pass').value
                                        ipcRenderer.send('validPassword', pass);
                                        ipcRenderer.on('validPassword', (event, valid) => {
                                            ipcRenderer.removeAllListeners('validPassword');
                                            if (valid) {
                                                vue.config_monitor_3.show_monitor = vue.config_monitor_3.show_monitor
                                                this.salvar();
                                                return;
                                            } else {
                                                debugger
                                                alerta = $.alert({
                                                    title: 'Atenção!',
                                                    content: 'Senha Incorreta',
                                                })
                                                vue.config_monitor_3.show_monitor = !vue.config_monitor_3.show_monitor
                                            }
                                        })
                                    },
                                },
                            }
                        })
                    } else if (value == 4) {
                        vue.config_monitor_4.show_monitor = !vue.config_monitor_4.show_monitor
                        var jquery = $.confirm({
                            title: 'Atenção!',
                            content: 'Por favor, selecione a senha de administrador para alterar a imagem.' + `
                                <div style="padding: 4px;">
                                    <div class="form-group mt-2">
                                        <input type="password" placeholder="Senha" class="pass form-control" required />
                                    </div>
                                </div>`,
                            type: 'red',
                            buttons: {
                                cancel: {
                                    text: 'Cancelar',
                                    btnClass: 'btn-danger',
                                    action: function () {
                                        vue.config_monitor_4.show_monitor = !vue.config_monitor_4.show_monitor
                                    }
                                },
                                confirm: {
                                    text: 'Confirmar',
                                    btnClass: 'btn-success',
                                    action: function () {
                                        var alerta = null;
                                        const pass = document.querySelector('.pass').value
                                        ipcRenderer.send('validPassword', pass);
                                        ipcRenderer.on('validPassword', (event, valid) => {
                                            ipcRenderer.removeAllListeners('validPassword');
                                            if (valid) {
                                                vue.config_monitor_4.show_monitor = vue.config_monitor_4.show_monitor
                                                this.salvar();
                                                return;
                                            } else {
                                                debugger
                                                alerta = $.alert({
                                                    title: 'Atenção!',
                                                    content: 'Senha Incorreta',
                                                })
                                                vue.config_monitor_4.show_monitor = !vue.config_monitor_4.show_monitor
                                            }
                                        })
                                    },
                                },
                            }
                        })
                    } else if (value == 5) {
                        this.config_monitor_5.show_monitor = !this.config_monitor_5.show_monitor
                        var jquery = $.confirm({
                            title: 'Atenção!',
                            content: 'Por favor, selecione a senha de administrador para alterar a imagem.' + `
                                <div style="padding: 4px;">
                                    <div class="form-group mt-2">
                                        <input type="password" placeholder="Senha" class="pass form-control" required />
                                    </div>
                                </div>`,
                            type: 'red',
                            buttons: {
                                cancel: {
                                    text: 'Cancelar',
                                    btnClass: 'btn-danger',
                                    action: function () {
                                        vue.config_monitor_5.show_monitor = !vue.config_monitor_5.show_monitor
                                    }
                                },
                                confirm: {
                                    text: 'Confirmar',
                                    btnClass: 'btn-success',
                                    action: function () {
                                        var alerta = null;
                                        const pass = document.querySelector('.pass').value
                                        ipcRenderer.send('validPassword', pass);
                                        ipcRenderer.on('validPassword', (event, valid) => {
                                            ipcRenderer.removeAllListeners('validPassword');
                                            if (valid) {
                                                vue.config_monitor_5.show_monitor = vue.config_monitor_5.show_monitor
                                                this.salvar();
                                                return;
                                            } else {
                                                debugger
                                                alerta = $.alert({
                                                    title: 'Atenção!',
                                                    content: 'Senha Incorreta',
                                                })
                                                vue.config_monitor_5.show_monitor = !vue.config_monitor_5.show_monitor
                                            }
                                        })
                                    },
                                },
                            }
                        })

                    }

                },
                changeTela(i, tipo = false) {
                    if (tipo == true) {
                        vue['config_monitor_' + i].monitor = this.edit.monitor;
                    }
                    if (vue['config_monitor_' + i].monitor == 'Default') {
                        vue['config_monitor_' + i].x = 0;
                        vue['config_monitor_' + i].y = 0;
                        vue['config_monitor_' + i].tipo = 'personalizado';
                        if (tipo) {
                            this.edit.x = 0;
                            this.edit.y = 0;
                            this.edit.tipo = 'personalizado';
                        }
                    }
                    for (e of this.telas) {
                        if (vue['config_monitor_' + i].monitor == e.label) {
                            console.log(e.bounds);
                            if (tipo) {
                                this.edit.x = e.bounds.x + 1;
                                this.edit.y = e.bounds.y;
                                this.edit.tipo = 'monitor';
                            }
                            vue['config_monitor_' + i].x = e.bounds.x + 1;
                            vue['config_monitor_' + i].y = e.bounds.y;
                            vue['config_monitor_' + i].tipo = 'monitor';
                        }
                    }
                    this.salvar();
                },
                async getData() {
                    let configMonitor;
                    const dbPath = path.join(process.cwd(), 'scoreboard.sqlite');
                    var db = new sqlite3.Database(dbPath);
                    configMonitor = await new Promise((resolve, reject) => {
                        db.all("SELECT * FROM config_monitor", (err, rows) => {
                            if (err) {
                                console.error(err.message);
                                reject(err);
                            }
                            resolve(rows);
                        });
                    });
                    db.close();
                    this.getTelas();
                    this.config_monitors = configMonitor;
                    for (var i = 1; i <= this.config_monitors.length; i++) {
                        this['config_monitor_' + i] = this.config_monitors[i - 1];
                    }
                    // Carregar status do banner web
                    this.loadBannerWebConfig();
                },
                abrirModal(tela, tipo) {
                    this.edit.config = tipo;
                    this.edit.id = tela.id;
                    this.edit.width = tela.width;
                    this.edit.height = tela.height;
                    this.edit.x = tela.x;
                    this.edit.y = tela.y;
                    this.edit.fullscreen = tela.fullscreen;
                    this.edit.monitor = tela.monitor;
                    this.edit.min_width = tela.min_width;
                    this.edit.min_height = tela.min_height;
                    this.edit.tipo = tela.tipo;
                },
                async salvar() {

                    let query_1 = `
                        UPDATE config_monitor SET
                            show_monitor = ${this.config_monitor_1.show_monitor},
                            width = ${this.config_monitor_1.width},
                            height = ${this.config_monitor_1.height},
                            x = ${this.config_monitor_1.x},
                            y = ${this.config_monitor_1.y},
                            fullscreen = ${this.config_monitor_1.fullscreen},
                            monitor = '${this.config_monitor_1.monitor}'
                        where id = ${this.config_monitor_1.id}
                    `
                    let query_2 = `
                        UPDATE config_monitor SET
                            width = ${this.config_monitor_2.width},
                            height = ${this.config_monitor_2.height},
                            x = ${this.config_monitor_2.x},
                            y = ${this.config_monitor_2.y},
                            fullscreen = ${this.config_monitor_2.fullscreen},
                            monitor = '${this.config_monitor_2.monitor}'
                        where id = ${this.config_monitor_2.id}
                    `
                    let query_3 = `
                        UPDATE config_monitor SET
                            show_monitor = ${this.config_monitor_3.show_monitor},
                            width = ${this.config_monitor_3.width},
                            height = ${this.config_monitor_3.height},
                            x = ${this.config_monitor_3.x},
                            y = ${this.config_monitor_3.y},
                            fullscreen = ${this.config_monitor_3.fullscreen},
                            monitor = '${this.config_monitor_3.monitor}'
                        where id = ${this.config_monitor_3.id}
                    `
                    let query_4 = `
                        UPDATE config_monitor SET
                            show_monitor = ${this.config_monitor_4.show_monitor},
                            width = ${this.config_monitor_4.width},
                            height = ${this.config_monitor_4.height},
                            x = ${this.config_monitor_4.x},
                            fullscreen = ${this.config_monitor_4.fullscreen},
                            y = ${this.config_monitor_4.y},
                            monitor = '${this.config_monitor_4.monitor}'
                        where id = ${this.config_monitor_4.id}
                    `
                    let query_5 = `
                        UPDATE config_monitor SET
                            show_monitor = ${this.config_monitor_5.show_monitor},
                            width = ${this.config_monitor_5.width},
                            height = ${this.config_monitor_5.height},
                            x = ${this.config_monitor_5.x},
                            y = ${this.config_monitor_5.y},
                            fullscreen = ${this.config_monitor_5.fullscreen},
                            monitor = '${this.config_monitor_5.monitor}'
                        where id = ${this.config_monitor_5.id}
                    `
                    let arr = [query_1, query_2, query_3, query_4, query_5];
                    var db = new sqlite3.Database('./scoreboard.sqlite');
                    try {
                        for (const query of arr) {
                            await new Promise((resolve, reject) => {
                                db.run(query, (err) => {
                                    if (err) {
                                        reject(err);
                                    } else {
                                        resolve();
                                    }
                                });
                            });
                        }
                    } catch (error) {
                        ipcRenderer.send('send-alert', 'Falha ao salvar configurações, tente novamente.');
                    } finally {
                        db.close();
                    }
                    console.log("Salvo com sucesso!");
                    ipcRenderer.send('atualizacaoTelas')

                },
                async salvar_item() {
                    if (this.edit.width < this.edit.min_width || this.edit.height < this.edit.min_height) {
                        ipcRenderer.send('send-alert', 'Dimensões inválidas.');
                        return;
                    }
                    let query = `
                        UPDATE config_monitor SET
                            width = ${this.edit.width},
                            height = ${this.edit.height},
                            x = ${this.edit.x},
                            y = ${this.edit.y},
                            fullscreen = ${this.edit.fullscreen},
                            tipo = '${this.edit.tipo}',
                            monitor = '${this.edit.monitor}'
                        where id = ${this.edit.id}
                    `
                    const dbPath = path.join(process.cwd(), 'scoreboard.sqlite');
                    var db = new sqlite3.Database(dbPath);
                    try {
                        await new Promise((resolve, reject) => {
                            db.run(query, (err) => {
                                if (err) {
                                    reject(err);
                                } else {
                                    resolve();
                                }
                            });
                        });
                    } catch (error) {
                        ipcRenderer.send('send-alert', 'Falha ao salvar configurações, tente novamente.');
                    } finally {
                        db.close();
                    }
                    console.log("Salvo com sucesso!");
                    ipcRenderer.send('atualizacaoTelas')
                    var modal = bootstrap.Modal.getInstance(document.getElementById('exampleModal'));
                    modal.hide();
                    this.getData();
                    this.getData();
                }
            },
            mounted() {
                // alert('Carrega')
                this.getData();
            }
        })

    </script>
    <script>
        window.onload = function () {
            getConfigSetup();
        }

        function openTab(tabName, elem) {
            window.location.href = tabName + ".html";
        }

        function retornar() {
            if (confirm("Você tem certeza que deseja reiniciar tudo?\n\n" +
                "Clique em OK para salvar as alterações e reiniciar.\n" +
                "Clique em Cancelar caso não deseje reiniciar.")) {
                ipcRenderer.send("closeWindowConfig", true);
            } else {
                ipcRenderer.send("closeWindowConfig", false);
            }
        }

    </script>
</body>

</html>